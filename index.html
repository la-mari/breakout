<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Breakout Game using Phaser</title>
	<style>* {padding: 0; margin: 0;}</style>
	<script src="js/phaser.min.js"></script>
</head>
<body>
<script>
	var game = new Phaser.Game(480, 320, Phaser.AUTO, null, {
		preload: preload, create: create, update: update
	});

	var pelota;
	var paddle;
	var ladrillo;
	var newLadrillo;
	var ladrilloInfo;

	function preload() {
		game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
		game.scale.pageAlignHorizontally = true;
		game.scale.pageAlignVertically = true;
		game.stage.backgroundColor = '#eee';
		game.load.image('pelota', 'assets/pelota.png');
		game.load.image('paleta', 'assets/paleta.png');
		game.load.image('ladrillo', 'assets/ladrillo.png');

	}

	function create() {
		//initialize the arcade physics engine
		game.physics.startSystem(Phaser.Physics.ARCADE);
		//position the ball
		pelota = game.add.sprite(game.world.width*0.5, game.world.height-25, 'pelota');
		pelota.anchor.set(0.5);

		game.physics.enable(pelota, Phaser.Physics.ARCADE);
		//set walls as boundaries so ball stops at wall
		pelota.body.collideWorldBounds = true;
		pelota.body.bounce.set(1);
		pelota.body.velocity.set(150, -150);

		//no ball collision at bottom edge of screen, lose game
		game.physics.arcade.checkCollision.down = false;
		pelota.checkWorldBounds = true;
		pelota.events.onOutOfBounds.add(function(){
			alert('GAME OVER!');
			//click alert to reload game
			location.reload();
		}, this);

		//render the paddle
		paleta = game.add.sprite(game.world.width*0.5, game.world.height-5, 'paleta');
		paleta.anchor.set(0.5,1);
		//enable physics so ball can hit paddle
		game.physics.enable(paleta, Phaser.Physics.ARCADE);
		//make paddle immoveable so it won't move when ball hits it
		paleta.body.immovable = true;

		initLadrillos();
	}

	function update() {
		game.physics.arcade.collide(pelota, paleta);
		//set paddle position to input positions
		paleta.x = game.input.x || game.world.width*0.5;
		// pelota.x += 1;
		// pelota.y += 1;
	}

	//draw ladrillos
	function initLadrillos(){
		ladrilloInfo = {
			width: 50,
			height: 20,
			count: {
				row: 7,
				col: 3
			},
			offset: {
				top: 50,
				left: 60
			},
			padding: 10
		}
		//add group to create the ladrillos
		ladrillos = game.add.group();
		for(i=0; i<ladrilloInfo.count.col; i++){
			for(j=0; j<ladrilloInfo.count.row; j++){
				var ladrilloX = (j*(ladrilloInfo.width+ladrilloInfo.padding))+ladrilloInfo.offset.left;
				var ladrilloY = (i*(ladrilloInfo.height+ladrilloInfo.padding))+ladrilloInfo.offset.top;
				newLadrillo = game.add.sprite(ladrilloX, ladrilloY, 'ladrillo');
				game.physics.enable(newLadrillo, Phaser.Physics.ARCADE);
				newLadrillo.body.immovable = true;
				newLadrillo.anchor.set(0.5);
				ladrillos.add(newLadrillo);
			}
		}
	}






</script>

</body>
</html>